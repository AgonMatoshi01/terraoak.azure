[
    {
        "CapabilityId": "Oak9.CR.KM.1",
        "CapabilityName": "",
        "Source": "Azure",
        "ResourceName": "foo",
        "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
        "ResourceType": "Microsoft.KeyVault",
        "ResourceGap": "Critical",
        "HasResourceGap": true,
        "ResourceImpact": "Critical",
        "HasResourceImpact": true,
        "Violations": [
            {
                "Severity": "Low",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.KM.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.enable_soft_delete",
                "HasConfigId": true,
                "ConfigValue": "False",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#ensure-key-availability",
                "HasOak9Guidance": true,
                "PrefferedValue": "True",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "",
                "HasConfigImpact": true
            },
            {
                "Severity": "Low",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.KM.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.create_mode",
                "HasConfigId": true,
                "ConfigValue": "",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#ensure-key-availability",
                "HasOak9Guidance": true,
                "PrefferedValue": "recover",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "Data protected by these keys may not be recoverable in the case the key is lost or destroyed",
                "HasConfigImpact": true
            }
        ],
        "Oak9Guidance": "",
        "HasOak9Guidance": false,
        "MappedIndustryFrameworks": []
    },
    {
        "CapabilityId": "Oak9.CR.AE.2",
        "CapabilityName": "",
        "Source": "Azure",
        "ResourceName": "foo",
        "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
        "ResourceType": "Microsoft.KeyVault",
        "ResourceGap": "Critical",
        "HasResourceGap": true,
        "ResourceImpact": "Critical",
        "HasResourceImpact": true,
        "Violations": [
            {
                "Severity": "Critical",
                "HasSeverity": true,
                "ConfigGap": "Role based access control (RBAC) is the preferred approach to control access to key vaults. However, if you prefer to use access policies specify [configId]",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.AE.2",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults_access_policies",
                "HasConfigId": true,
                "ConfigValue": "[]",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#access-control-policy",
                "HasOak9Guidance": true,
                "PrefferedValue": "",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "Specify resource based access control policies for [configId].",
                "HasConfigFix": true,
                "ConfigImpact": "",
                "HasConfigImpact": true
            },
            {
                "Severity": "Moderate",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.AE.2",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.enabled_for_disk_encryption",
                "HasConfigId": true,
                "ConfigValue": "True",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#access-control-policy",
                "HasOak9Guidance": true,
                "PrefferedValue": "False",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "Explicitly define whether Disk Encryption Services can access secrets",
                "HasConfigFix": true,
                "ConfigImpact": "Policy for Disk Encryption Services accessing secrets is not explicitly defined",
                "HasConfigImpact": true
            },
            {
                "Severity": "Moderate",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.AE.2",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.enabled_for_template_deployment",
                "HasConfigId": true,
                "ConfigValue": "True",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#access-control-policy",
                "HasOak9Guidance": true,
                "PrefferedValue": "False",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "Explicitly define whether Azure Resource Manager can access secrets",
                "HasConfigFix": true,
                "ConfigImpact": "Policy for Azure Resource Manager accessing secrets is not explicitly defined",
                "HasConfigImpact": true
            }
        ],
        "Oak9Guidance": "",
        "HasOak9Guidance": false,
        "MappedIndustryFrameworks": []
    },
    {
        "CapabilityId": "Oak9.CR.AI.1",
        "CapabilityName": "",
        "Source": "Azure",
        "ResourceName": "foo",
        "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
        "ResourceType": "Microsoft.KeyVault",
        "ResourceGap": "Critical",
        "HasResourceGap": true,
        "ResourceImpact": "Critical",
        "HasResourceImpact": true,
        "Violations": [
            {
                "Severity": "Moderate",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.AI.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.tags",
                "HasConfigId": true,
                "ConfigValue": "{}",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#asset-inventory",
                "HasOak9Guidance": true,
                "PrefferedValue": "",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "Tagging is a best practice to ensure that resources are organized accurately. Set [configId] to ensure that the right tags are applied to this resource",
                "HasConfigFix": true,
                "ConfigImpact": "This makes it harder to manage, organize or identify resources",
                "HasConfigImpact": true
            }
        ],
        "Oak9Guidance": "",
        "HasOak9Guidance": false,
        "MappedIndustryFrameworks": []
    },
    {
        "CapabilityId": "Oak9.CR.IFE.1",
        "CapabilityName": "",
        "Source": "Azure",
        "ResourceName": "foo",
        "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
        "ResourceType": "Microsoft.KeyVault",
        "ResourceGap": "Critical",
        "HasResourceGap": true,
        "ResourceImpact": "Critical",
        "HasResourceImpact": true,
        "Violations": [
            {
                "Severity": "Critical",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.IFE.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.network_acls.bypass",
                "HasConfigId": true,
                "ConfigValue": "",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#firewalls",
                "HasOak9Guidance": true,
                "PrefferedValue": "",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "",
                "HasConfigImpact": true
            },
            {
                "Severity": "Low",
                "HasSeverity": true,
                "ConfigGap": "[configId] is not set to restrict network traffic to necessary IPs",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.IFE.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.network_acls.ip_rules",
                "HasConfigId": true,
                "ConfigValue": "[]",
                "HasConfigValue": true,
                "Oak9Guidance": "",
                "HasOak9Guidance": true,
                "PrefferedValue": "",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "This could lead to unauthorized access",
                "HasConfigImpact": true
            },
            {
                "Severity": "Moderate",
                "HasSeverity": true,
                "ConfigGap": "[configId] is not set to restrict network traffic to necessary virtual networks",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.IFE.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.network_acls.virtual_network_rules",
                "HasConfigId": true,
                "ConfigValue": "[]",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#firewalls",
                "HasOak9Guidance": true,
                "PrefferedValue": "",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "This could lead to unauthorized access",
                "HasConfigImpact": true
            },
            {
                "Severity": "Critical",
                "HasSeverity": true,
                "ConfigGap": "",
                "HasConfigGap": true,
                "CapabilityId": "Oak9.CR.IFE.1",
                "HasCapabilityId": true,
                "ResourceId": "Microsoft.KeyVault-05bbaa15-6e22-9b5a-d336-7fd6c1110032",
                "HasResourceId": true,
                "ResourceType": "Microsoft.KeyVault",
                "HasResourceType": true,
                "ConfigId": "microsoft_key_vault.vaults.network_acls.default_action",
                "HasConfigId": true,
                "ConfigValue": "",
                "HasConfigValue": true,
                "Oak9Guidance": "https://docs.oak9.io/oak9/design-gap-documentation/azure/microsoft-keyvault#deny-all-communications-and-only-allow-by-exception",
                "HasOak9Guidance": true,
                "PrefferedValue": "deny",
                "HasPrefferedValue": true,
                "CapabilityName": "",
                "HasCapabilityName": true,
                "ConfigFix": "",
                "HasConfigFix": true,
                "ConfigImpact": "",
                "HasConfigImpact": true
            }
        ],
        "Oak9Guidance": "",
        "HasOak9Guidance": false,
        "MappedIndustryFrameworks": []
    }
]